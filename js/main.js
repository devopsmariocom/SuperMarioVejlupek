document.addEventListener("DOMContentLoaded",(()=>{const t=new Game,e=document.getElementById("gameCanvas"),i=e.getContext("2d");function n(){e.width=window.innerWidth,e.height=window.innerHeight,o()}function o(){i.fillStyle="#87CEEB",i.fillRect(0,0,e.width,e.height);const t=Math.min(e.width/800,e.height/600),n=Math.max(32,Math.floor(48*t)),o=Math.max(18,Math.floor(24*t)),l=Math.max(30,Math.floor(40*t));i.fillStyle="#000000",i.font=`${n}px Arial`,i.textAlign="center",i.fillText("PLATFORM GAME",e.width/2,e.height/3),i.font=`${o}px Arial`;const d=1.5*o,h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);h?i.fillText("Use on-screen buttons to move and jump",e.width/2,e.height/2):i.fillText("Use arrow keys or WASD to move",e.width/2,e.height/2),i.fillText("Jump on enemies to defeat them",e.width/2,e.height/2+d);const r=e.height/2+2.5*d;if(h){const t="TAP HERE TO START",n=i.measureText(t).width,l=1.2*o;i.fillStyle="rgba(255, 87, 34, 0.8)",i.fillRect(e.width/2-n/2-l,r-o-l/2,n+2*l,o+l),i.fillStyle="white",i.fillText(t,e.width/2,r),window.startButtonArea={x:e.width/2-n/2-l,y:r-o-l/2,width:n+2*l,height:o+l}}else i.fillStyle="#000000",i.fillText("Press SPACE to start",e.width/2,r);i.fillStyle="#FF0000",i.fillRect(e.width/2-l/2,.7*e.height,l,1.5*l);const a=Math.max(3,Math.floor(5*t));i.fillStyle="#FFFFFF",i.fillRect(e.width/2-l/4,.7*e.height+l/4,a,a),i.fillRect(e.width/2+l/8,.7*e.height+l/4,a,a),h||(i.fillStyle="rgba(0, 0, 0, 0.7)",i.fillText("Click the Fullscreen button for best experience",e.width/2,e.height-2*o))}n(),window.addEventListener("resize",n),o();const l=document.getElementById("fullscreenButton"),d=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),h=(/iPad|iPhone|iPod/.test(navigator.userAgent),e=>{console.log("Fullscreen button clicked"),e&&(e.preventDefault(),e.stopPropagation()),t.toggleFullscreen(),setTimeout(o,200)});function r(t){" "!==t.key&&"Space"!==t.code||s()}function a(t){t.preventDefault();const e=t.touches[0],i=e.clientX,n=e.clientY;if(window.startButtonArea){const t=window.startButtonArea;i>=t.x&&i<=t.x+t.width&&n>=t.y&&n<=t.y+t.height&&s()}else s()}function s(){window.removeEventListener("keydown",r),window.removeEventListener("resize",n),e.removeEventListener("touchstart",a),t.start()}d||l.addEventListener("click",h),d&&(window.addEventListener("orientationchange",(()=>{setTimeout(o,300)})),window.addEventListener("resize",(()=>{t.isRunning||setTimeout(o,300)}))),window.addEventListener("keydown",r),e.addEventListener("touchstart",a,{passive:!1})}));